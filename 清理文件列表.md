# é¡¹ç›®æ–‡ä»¶æ¸…ç†åˆ—è¡¨

## ğŸ—‘ï¸ å»ºè®®åˆ é™¤çš„æ–‡ä»¶

### Docker ç›¸å…³æ–‡ä»¶ï¼ˆä¸å†ä½¿ç”¨ Docker éƒ¨ç½²ï¼‰
- [ ] `Dockerfile` - Docker é•œåƒæ„å»ºæ–‡ä»¶
- [ ] `Dockerfile.simple` - ç®€åŒ–ç‰ˆ Docker æ–‡ä»¶
- [ ] `docker-compose.yml` - Docker Compose é…ç½®
- [ ] `.dockerignore` - Docker å¿½ç•¥æ–‡ä»¶
- [ ] `DEPLOY-CLOUD.md` - Docker äº‘éƒ¨ç½²æ–‡æ¡£

### é‡å¤/è¿‡æ—¶çš„å¤‡ä»½è„šæœ¬
- [ ] `backup-db.sh` - æ—§ç‰ˆå¤‡ä»½è„šæœ¬ï¼ˆå·²è¢« `backup_database.sh` æ›¿ä»£ï¼‰
- [ ] `install-backup-cron.sh` - æ—§ç‰ˆå®‰è£…è„šæœ¬ï¼ˆå·²è¢« `setup_backup_cron.sh` æ›¿ä»£ï¼‰

### é‡å¤/è¿‡æ—¶çš„éƒ¨ç½²è„šæœ¬
- [ ] `deploy.sh` - Docker éƒ¨ç½²è„šæœ¬ï¼ˆä¸å†ä½¿ç”¨ï¼‰
- [ ] `diagnose-and-fix.sh` - è¯Šæ–­è„šæœ¬ï¼ˆåŠŸèƒ½å·²æ•´åˆåˆ°æ–°è„šæœ¬ï¼‰
- [ ] `fix-network.sh` - ç½‘ç»œä¿®å¤è„šæœ¬ï¼ˆå·²è¿‡æ—¶ï¼‰
- [ ] `restart-server.sh` - é‡å¯è„šæœ¬ï¼ˆåŠŸèƒ½ç®€å•ï¼Œå¯ç”¨ systemctl æ›¿ä»£ï¼‰
- [ ] `rollback-server.sh` - å›æ»šè„šæœ¬ï¼ˆå·²è¿‡æ—¶ï¼‰
- [ ] `setup-china-mirrors.sh` - é•œåƒé…ç½®è„šæœ¬ï¼ˆå·²è¿‡æ—¶ï¼‰
- [ ] `test_production_config.sh` - æµ‹è¯•è„šæœ¬ï¼ˆå·²è¿‡æ—¶ï¼‰
- [ ] `verify-deployment.sh` - éªŒè¯è„šæœ¬ï¼ˆå·²è¿‡æ—¶ï¼‰

### é‡å¤/è¿‡æ—¶çš„æ–‡æ¡£
- [ ] `CHINA-MIRRORS.md` - å›½å†…é•œåƒæ–‡æ¡£ï¼ˆå·²è¿‡æ—¶ï¼‰
- [ ] `CONFIG.md` - é…ç½®æ–‡æ¡£ï¼ˆå·²è¿‡æ—¶ï¼‰
- [ ] `DEPLOYMENT_FIX.md` - éƒ¨ç½²ä¿®å¤æ–‡æ¡£ï¼ˆå·²è¿‡æ—¶ï¼‰
- [ ] `ECS_DEPLOYMENT_GUIDE.md` - ECS éƒ¨ç½²æŒ‡å—ï¼ˆå·²è¢«æ–°æ–‡æ¡£æ›¿ä»£ï¼‰
- [ ] `README-backup.md` - README å¤‡ä»½ï¼ˆä¸éœ€è¦ï¼‰
- [ ] `REQUIREMENTS.md` - éœ€æ±‚æ–‡æ¡£ï¼ˆå·²è¿‡æ—¶ï¼‰
- [ ] `ä¿®å¤æ€»ç»“.md` - ä¿®å¤æ€»ç»“ï¼ˆå†å²æ–‡æ¡£ï¼Œå¯åˆ é™¤ï¼‰
- [ ] `å®¢æˆ·åˆ—è¡¨æƒé™ä¿®æ”¹è¯´æ˜.md` - æƒé™ä¿®æ”¹è¯´æ˜ï¼ˆå†å²æ–‡æ¡£ï¼Œå¯åˆ é™¤ï¼‰
- [ ] `æœåŠ¡å™¨æ›´æ–°æŒ‡å—.md` - æ›´æ–°æŒ‡å—ï¼ˆå·²è¢«æ–°æ–‡æ¡£æ›¿ä»£ï¼‰

### é‡å¤çš„æ•°æ®åº“æ–‡ä»¶
- [ ] `instance/edu_crm1.db` - é‡å¤çš„æ•°æ®åº“æ–‡ä»¶ï¼ˆä¿ç•™ `edu_crm.db` å³å¯ï¼‰

### æµ‹è¯•/ä¸´æ—¶æ–‡ä»¶
- [ ] `fix_test_data.py` - æµ‹è¯•æ•°æ®ä¿®å¤è„šæœ¬ï¼ˆä¸€æ¬¡æ€§ä½¿ç”¨ï¼Œå·²å®Œæˆï¼‰
- [ ] `migrate_user_roles.py` - ç”¨æˆ·è§’è‰²è¿ç§»è„šæœ¬ï¼ˆä¸€æ¬¡æ€§ä½¿ç”¨ï¼Œå·²å®Œæˆï¼‰
- [ ] `test_config.py` - é…ç½®æµ‹è¯•æ–‡ä»¶ï¼ˆå¼€å‘ç”¨ï¼Œå¯åˆ é™¤ï¼‰

### å¼€å‘ä¾èµ–æ–‡ä»¶ï¼ˆå¯é€‰åˆ é™¤ï¼‰
- [ ] `requirements-dev.txt` - å¼€å‘ä¾èµ–ï¼ˆå¦‚æœä¸åœ¨æœåŠ¡å™¨ä¸Šå¼€å‘å¯åˆ é™¤ï¼‰
- [ ] `requirements-minimal.txt` - æœ€å°ä¾èµ–ï¼ˆå·²ä¸ä½¿ç”¨ï¼‰

---

## âœ… ä¿ç•™çš„é‡è¦æ–‡ä»¶

### æ ¸å¿ƒåº”ç”¨æ–‡ä»¶
- âœ… `run.py` - åº”ç”¨å…¥å£
- âœ… `models.py` - æ•°æ®æ¨¡å‹
- âœ… `config.py` - é…ç½®æ–‡ä»¶
- âœ… `communication_utils.py` - å·¥å…·ç±»
- âœ… `gunicorn.conf.py` - Gunicorn é…ç½®
- âœ… `requirements.txt` - ç”Ÿäº§ä¾èµ–

### æ•°æ®åº“ç›¸å…³
- âœ… `add_user_id_to_communications.py` - æ•°æ®åº“è¿ç§»è„šæœ¬
- âœ… `instance/edu_crm.db` - ä¸»æ•°æ®åº“æ–‡ä»¶

### å¤‡ä»½ç›¸å…³
- âœ… `backup_database.sh` - æ•°æ®åº“å¤‡ä»½è„šæœ¬
- âœ… `setup_backup_cron.sh` - å¤‡ä»½é…ç½®è„šæœ¬
- âœ… `deploy_migration.sh` - æ•°æ®åº“è¿ç§»éƒ¨ç½²è„šæœ¬

### æ–‡æ¡£
- âœ… `README.md` - é¡¹ç›®è¯´æ˜
- âœ… `æ•°æ®åº“å¤‡ä»½ä½¿ç”¨è¯´æ˜.md` - å¤‡ä»½æ–‡æ¡£
- âœ… `æ•°æ®åº“ç»“æ„è¯´æ˜.md` - æ•°æ®åº“æ–‡æ¡£
- âœ… `æœåŠ¡å™¨éƒ¨ç½²å‘½ä»¤-ç®€åŒ–ç‰ˆ.md` - ç®€åŒ–éƒ¨ç½²æ–‡æ¡£
- âœ… `æœåŠ¡å™¨éƒ¨ç½²å®Œæ•´æŒ‡å—.md` - å®Œæ•´éƒ¨ç½²æ–‡æ¡£
- âœ… `éƒ¨ç½²æŒ‡å—-æ•°æ®åº“è¿ç§».md` - è¿ç§»æ–‡æ¡£
- âœ… `å¿«é€Ÿéƒ¨ç½²å‘½ä»¤.txt` - å¿«é€Ÿå‚è€ƒ
- âœ… `æ²Ÿé€šè®°å½•å¡«å†™äººåŠŸèƒ½è¯´æ˜.md` - åŠŸèƒ½è¯´æ˜
- âœ… `æµ‹è¯•è´¦å·ä¿¡æ¯.md` - æµ‹è¯•è´¦å·

### ç›®å½•
- âœ… `routes/` - è·¯ç”±æ–‡ä»¶
- âœ… `templates/` - æ¨¡æ¿æ–‡ä»¶
- âœ… `static/` - é™æ€æ–‡ä»¶
- âœ… `utils/` - å·¥å…·å‡½æ•°
- âœ… `instance/` - æ•°æ®åº“ç›®å½•
- âœ… `venv/` - è™šæ‹Ÿç¯å¢ƒ

---

## ğŸ“Š æ¸…ç†ç»Ÿè®¡

### å¯åˆ é™¤æ–‡ä»¶æ•°é‡
- Docker ç›¸å…³ï¼š5 ä¸ªæ–‡ä»¶
- é‡å¤/è¿‡æ—¶è„šæœ¬ï¼š10 ä¸ªæ–‡ä»¶
- é‡å¤/è¿‡æ—¶æ–‡æ¡£ï¼š10 ä¸ªæ–‡ä»¶
- æµ‹è¯•/ä¸´æ—¶æ–‡ä»¶ï¼š3 ä¸ªæ–‡ä»¶
- å…¶ä»–ï¼š2 ä¸ªæ–‡ä»¶

**æ€»è®¡ï¼šçº¦ 30 ä¸ªæ–‡ä»¶å¯ä»¥åˆ é™¤**

### æ¸…ç†åçš„å¥½å¤„
1. âœ… é¡¹ç›®ç»“æ„æ›´æ¸…æ™°
2. âœ… å‡å°‘æ··æ·†å’Œè¯¯ç”¨
3. âœ… é™ä½ç»´æŠ¤æˆæœ¬
4. âœ… å‡å°ä»“åº“å¤§å°

---

## ğŸš€ æ‰§è¡Œæ¸…ç†

### æ–¹æ³• 1ï¼šä¸€é”®æ¸…ç†è„šæœ¬

åˆ›å»º `cleanup.sh` è„šæœ¬ï¼š

```bash
#!/bin/bash

echo "å¼€å§‹æ¸…ç†é¡¹ç›®æ–‡ä»¶..."

# Docker ç›¸å…³
rm -f Dockerfile Dockerfile.simple docker-compose.yml .dockerignore

# è¿‡æ—¶è„šæœ¬
rm -f backup-db.sh install-backup-cron.sh deploy.sh diagnose-and-fix.sh
rm -f fix-network.sh restart-server.sh rollback-server.sh
rm -f setup-china-mirrors.sh test_production_config.sh verify-deployment.sh

# è¿‡æ—¶æ–‡æ¡£
rm -f CHINA-MIRRORS.md CONFIG.md DEPLOYMENT_FIX.md ECS_DEPLOYMENT_GUIDE.md
rm -f README-backup.md REQUIREMENTS.md DEPLOY-CLOUD.md
rm -f ä¿®å¤æ€»ç»“.md å®¢æˆ·åˆ—è¡¨æƒé™ä¿®æ”¹è¯´æ˜.md æœåŠ¡å™¨æ›´æ–°æŒ‡å—.md

# æµ‹è¯•æ–‡ä»¶
rm -f fix_test_data.py migrate_user_roles.py test_config.py

# é‡å¤æ•°æ®åº“
rm -f instance/edu_crm1.db

# å¯é€‰ï¼šå¼€å‘ä¾èµ–
rm -f requirements-dev.txt requirements-minimal.txt

echo "æ¸…ç†å®Œæˆï¼"
echo "è¯·è¿è¡Œ 'git status' æŸ¥çœ‹å˜æ›´"
```

### æ–¹æ³• 2ï¼šæ‰‹åŠ¨åˆ é™¤

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /Users/blebleman/sync/SynologyDrive/CRM1

# åˆ é™¤ Docker ç›¸å…³
rm -f Dockerfile Dockerfile.simple docker-compose.yml .dockerignore DEPLOY-CLOUD.md

# åˆ é™¤è¿‡æ—¶è„šæœ¬
rm -f backup-db.sh install-backup-cron.sh deploy.sh diagnose-and-fix.sh
rm -f fix-network.sh restart-server.sh rollback-server.sh
rm -f setup-china-mirrors.sh test_production_config.sh verify-deployment.sh

# åˆ é™¤è¿‡æ—¶æ–‡æ¡£
rm -f CHINA-MIRRORS.md CONFIG.md DEPLOYMENT_FIX.md ECS_DEPLOYMENT_GUIDE.md
rm -f README-backup.md REQUIREMENTS.md
rm -f ä¿®å¤æ€»ç»“.md å®¢æˆ·åˆ—è¡¨æƒé™ä¿®æ”¹è¯´æ˜.md æœåŠ¡å™¨æ›´æ–°æŒ‡å—.md

# åˆ é™¤æµ‹è¯•æ–‡ä»¶
rm -f fix_test_data.py migrate_user_roles.py test_config.py

# åˆ é™¤é‡å¤æ•°æ®åº“
rm -f instance/edu_crm1.db

# å¯é€‰ï¼šåˆ é™¤å¼€å‘ä¾èµ–
rm -f requirements-dev.txt requirements-minimal.txt

# æŸ¥çœ‹å˜æ›´
git status

# æäº¤åˆ é™¤
git add -A
git commit -m "chore: æ¸…ç†è¿‡æ—¶å’Œé‡å¤çš„æ–‡ä»¶

åˆ é™¤å†…å®¹ï¼š
- Docker ç›¸å…³æ–‡ä»¶ï¼ˆä¸å†ä½¿ç”¨ Docker éƒ¨ç½²ï¼‰
- è¿‡æ—¶çš„éƒ¨ç½²è„šæœ¬å’Œæ–‡æ¡£
- é‡å¤çš„å¤‡ä»½è„šæœ¬
- ä¸€æ¬¡æ€§ä½¿ç”¨çš„è¿ç§»è„šæœ¬
- æµ‹è¯•å’Œä¸´æ—¶æ–‡ä»¶

ä¿ç•™å†…å®¹ï¼š
- æ ¸å¿ƒåº”ç”¨æ–‡ä»¶
- å½“å‰ä½¿ç”¨çš„å¤‡ä»½å’Œéƒ¨ç½²è„šæœ¬
- æœ€æ–°çš„éƒ¨ç½²æ–‡æ¡£"

git push github master:main
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å¤‡ä»½é‡è¦æ–‡ä»¶**ï¼šåˆ é™¤å‰ç¡®ä¿é‡è¦æ•°æ®å·²å¤‡ä»½
2. **ç¡®è®¤ä¸å†ä½¿ç”¨**ï¼šç¡®è®¤æ–‡ä»¶ç¡®å®ä¸å†éœ€è¦
3. **Git å†å²ä¿ç•™**ï¼šåˆ é™¤çš„æ–‡ä»¶ä»å¯ä» Git å†å²ä¸­æ¢å¤
4. **æœåŠ¡å™¨åŒæ­¥**ï¼šæ¸…ç†åéœ€è¦åœ¨æœåŠ¡å™¨ä¸ŠåŒæ­¥ï¼ˆgit pullï¼‰

---

**å»ºè®®**ï¼šå…ˆåœ¨æœ¬åœ°æ‰§è¡Œæ¸…ç†ï¼Œæµ‹è¯•æ— é—®é¢˜åå†æ¨é€åˆ°æœåŠ¡å™¨ã€‚

