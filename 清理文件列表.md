# 项目文件清理列表

## 🗑️ 建议删除的文件

### Docker 相关文件（不再使用 Docker 部署）
- [ ] `Dockerfile` - Docker 镜像构建文件
- [ ] `Dockerfile.simple` - 简化版 Docker 文件
- [ ] `docker-compose.yml` - Docker Compose 配置
- [ ] `.dockerignore` - Docker 忽略文件
- [ ] `DEPLOY-CLOUD.md` - Docker 云部署文档

### 重复/过时的备份脚本
- [ ] `backup-db.sh` - 旧版备份脚本（已被 `backup_database.sh` 替代）
- [ ] `install-backup-cron.sh` - 旧版安装脚本（已被 `setup_backup_cron.sh` 替代）

### 重复/过时的部署脚本
- [ ] `deploy.sh` - Docker 部署脚本（不再使用）
- [ ] `diagnose-and-fix.sh` - 诊断脚本（功能已整合到新脚本）
- [ ] `fix-network.sh` - 网络修复脚本（已过时）
- [ ] `restart-server.sh` - 重启脚本（功能简单，可用 systemctl 替代）
- [ ] `rollback-server.sh` - 回滚脚本（已过时）
- [ ] `setup-china-mirrors.sh` - 镜像配置脚本（已过时）
- [ ] `test_production_config.sh` - 测试脚本（已过时）
- [ ] `verify-deployment.sh` - 验证脚本（已过时）

### 重复/过时的文档
- [ ] `CHINA-MIRRORS.md` - 国内镜像文档（已过时）
- [ ] `CONFIG.md` - 配置文档（已过时）
- [ ] `DEPLOYMENT_FIX.md` - 部署修复文档（已过时）
- [ ] `ECS_DEPLOYMENT_GUIDE.md` - ECS 部署指南（已被新文档替代）
- [ ] `README-backup.md` - README 备份（不需要）
- [ ] `REQUIREMENTS.md` - 需求文档（已过时）
- [ ] `修复总结.md` - 修复总结（历史文档，可删除）
- [ ] `客户列表权限修改说明.md` - 权限修改说明（历史文档，可删除）
- [ ] `服务器更新指南.md` - 更新指南（已被新文档替代）

### 重复的数据库文件
- [ ] `instance/edu_crm1.db` - 重复的数据库文件（保留 `edu_crm.db` 即可）

### 测试/临时文件
- [ ] `fix_test_data.py` - 测试数据修复脚本（一次性使用，已完成）
- [ ] `migrate_user_roles.py` - 用户角色迁移脚本（一次性使用，已完成）
- [ ] `test_config.py` - 配置测试文件（开发用，可删除）

### 开发依赖文件（可选删除）
- [ ] `requirements-dev.txt` - 开发依赖（如果不在服务器上开发可删除）
- [ ] `requirements-minimal.txt` - 最小依赖（已不使用）

---

## ✅ 保留的重要文件

### 核心应用文件
- ✅ `run.py` - 应用入口
- ✅ `models.py` - 数据模型
- ✅ `config.py` - 配置文件
- ✅ `communication_utils.py` - 工具类
- ✅ `gunicorn.conf.py` - Gunicorn 配置
- ✅ `requirements.txt` - 生产依赖

### 数据库相关
- ✅ `add_user_id_to_communications.py` - 数据库迁移脚本
- ✅ `instance/edu_crm.db` - 主数据库文件

### 备份相关
- ✅ `backup_database.sh` - 数据库备份脚本
- ✅ `setup_backup_cron.sh` - 备份配置脚本
- ✅ `deploy_migration.sh` - 数据库迁移部署脚本

### 文档
- ✅ `README.md` - 项目说明
- ✅ `数据库备份使用说明.md` - 备份文档
- ✅ `数据库结构说明.md` - 数据库文档
- ✅ `服务器部署命令-简化版.md` - 简化部署文档
- ✅ `服务器部署完整指南.md` - 完整部署文档
- ✅ `部署指南-数据库迁移.md` - 迁移文档
- ✅ `快速部署命令.txt` - 快速参考
- ✅ `沟通记录填写人功能说明.md` - 功能说明
- ✅ `测试账号信息.md` - 测试账号

### 目录
- ✅ `routes/` - 路由文件
- ✅ `templates/` - 模板文件
- ✅ `static/` - 静态文件
- ✅ `utils/` - 工具函数
- ✅ `instance/` - 数据库目录
- ✅ `venv/` - 虚拟环境

---

## 📊 清理统计

### 可删除文件数量
- Docker 相关：5 个文件
- 重复/过时脚本：10 个文件
- 重复/过时文档：10 个文件
- 测试/临时文件：3 个文件
- 其他：2 个文件

**总计：约 30 个文件可以删除**

### 清理后的好处
1. ✅ 项目结构更清晰
2. ✅ 减少混淆和误用
3. ✅ 降低维护成本
4. ✅ 减小仓库大小

---

## 🚀 执行清理

### 方法 1：一键清理脚本

创建 `cleanup.sh` 脚本：

```bash
#!/bin/bash

echo "开始清理项目文件..."

# Docker 相关
rm -f Dockerfile Dockerfile.simple docker-compose.yml .dockerignore

# 过时脚本
rm -f backup-db.sh install-backup-cron.sh deploy.sh diagnose-and-fix.sh
rm -f fix-network.sh restart-server.sh rollback-server.sh
rm -f setup-china-mirrors.sh test_production_config.sh verify-deployment.sh

# 过时文档
rm -f CHINA-MIRRORS.md CONFIG.md DEPLOYMENT_FIX.md ECS_DEPLOYMENT_GUIDE.md
rm -f README-backup.md REQUIREMENTS.md DEPLOY-CLOUD.md
rm -f 修复总结.md 客户列表权限修改说明.md 服务器更新指南.md

# 测试文件
rm -f fix_test_data.py migrate_user_roles.py test_config.py

# 重复数据库
rm -f instance/edu_crm1.db

# 可选：开发依赖
rm -f requirements-dev.txt requirements-minimal.txt

echo "清理完成！"
echo "请运行 'git status' 查看变更"
```

### 方法 2：手动删除

```bash
# 进入项目目录
cd /Users/blebleman/sync/SynologyDrive/CRM1

# 删除 Docker 相关
rm -f Dockerfile Dockerfile.simple docker-compose.yml .dockerignore DEPLOY-CLOUD.md

# 删除过时脚本
rm -f backup-db.sh install-backup-cron.sh deploy.sh diagnose-and-fix.sh
rm -f fix-network.sh restart-server.sh rollback-server.sh
rm -f setup-china-mirrors.sh test_production_config.sh verify-deployment.sh

# 删除过时文档
rm -f CHINA-MIRRORS.md CONFIG.md DEPLOYMENT_FIX.md ECS_DEPLOYMENT_GUIDE.md
rm -f README-backup.md REQUIREMENTS.md
rm -f 修复总结.md 客户列表权限修改说明.md 服务器更新指南.md

# 删除测试文件
rm -f fix_test_data.py migrate_user_roles.py test_config.py

# 删除重复数据库
rm -f instance/edu_crm1.db

# 可选：删除开发依赖
rm -f requirements-dev.txt requirements-minimal.txt

# 查看变更
git status

# 提交删除
git add -A
git commit -m "chore: 清理过时和重复的文件

删除内容：
- Docker 相关文件（不再使用 Docker 部署）
- 过时的部署脚本和文档
- 重复的备份脚本
- 一次性使用的迁移脚本
- 测试和临时文件

保留内容：
- 核心应用文件
- 当前使用的备份和部署脚本
- 最新的部署文档"

git push github master:main
```

---

## ⚠️ 注意事项

1. **备份重要文件**：删除前确保重要数据已备份
2. **确认不再使用**：确认文件确实不再需要
3. **Git 历史保留**：删除的文件仍可从 Git 历史中恢复
4. **服务器同步**：清理后需要在服务器上同步（git pull）

---

**建议**：先在本地执行清理，测试无问题后再推送到服务器。

