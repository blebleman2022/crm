# é¡¹ç›®æ–‡ä»¶æ¸…å•

## ğŸ“‹ æ¸…ç†åçš„å®Œæ•´æ–‡ä»¶åˆ—è¡¨

### ğŸ”§ éƒ¨ç½²è„šæœ¬ï¼ˆ9ä¸ªï¼‰

| æ–‡ä»¶å | ç”¨é€” | ä¼˜å…ˆçº§ |
|--------|------|--------|
| **ubuntu-deploy.sh** | Ubuntuä¸€é”®éƒ¨ç½²è„šæœ¬ | â­â­â­ å¿…éœ€ |
| **quick-update.sh** | å¿«é€Ÿæ›´æ–°ä»£ç ï¼ˆ5-10ç§’ï¼‰ | â­â­â­ å¿…éœ€ |
| **health-check.sh** | å¥åº·æ£€æŸ¥å’Œè‡ªåŠ¨é‡å¯ | â­â­ æ¨è |
| **backup-to-gitee.sh** | å®Œæ•´å¤‡ä»½åˆ°bakåˆ†æ”¯ | â­â­ æ¨è |
| **restore-from-bak.sh** | ä»bakåˆ†æ”¯æ¢å¤ | â­â­ æ¨è |
| **setup-git-config.sh** | Gitç”¨æˆ·é…ç½® | â­ å¯é€‰ |
| **fix-git-conflict.sh** | Gitå†²çªä¿®å¤ | â­ å¯é€‰ |
| **verify-update.sh** | éªŒè¯æ›´æ–°çŠ¶æ€ | â­ å¯é€‰ |
| **cleanup-files.sh** | æ¸…ç†åºŸå¼ƒæ–‡ä»¶ | â­ å¯é€‰ |

---

### ğŸ“š æ–‡æ¡£æ–‡ä»¶ï¼ˆ13ä¸ªï¼‰

| æ–‡ä»¶å | ç”¨é€” | ä¼˜å…ˆçº§ |
|--------|------|--------|
| **README.md** | é¡¹ç›®æ€»ä½“è¯´æ˜ | â­â­â­ å¿…éœ€ |
| **Ubuntuç›´æ¥éƒ¨ç½²æŒ‡å—.md** | è¯¦ç»†éƒ¨ç½²æ­¥éª¤ | â­â­â­ å¿…éœ€ |
| **Ubuntuéƒ¨ç½²æ–¹æ¡ˆæ€»ç»“.md** | æ–¹æ¡ˆå®Œæ•´æ€»ç»“ | â­â­â­ å¿…éœ€ |
| **Ubuntuéƒ¨ç½²é—®é¢˜ä¿®å¤.md** | é—®é¢˜åˆ†æå’Œä¿®å¤ | â­â­ æ¨è |
| **Ubuntuéƒ¨ç½²æœ€ç»ˆæ£€æŸ¥æ¸…å•.md** | éƒ¨ç½²æ£€æŸ¥æ¸…å• | â­â­ æ¨è |
| **éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”ä¸å»ºè®®.md** | æ–¹æ¡ˆå¯¹æ¯”åˆ†æ | â­â­ æ¨è |
| **å¤‡ä»½æ¢å¤æŒ‡å—.md** | å¤‡ä»½æ¢å¤è¯¦ç»†è¯´æ˜ | â­â­ æ¨è |
| **æ•°æ®åº“ç®¡ç†è¯´æ˜.md** | æ•°æ®åº“ç®¡ç† | â­â­ æ¨è |
| **å®‰å…¨æ›´æ–°ä½¿ç”¨æŒ‡å—.md** | æ›´æ–°æµç¨‹è¯´æ˜ | â­ å‚è€ƒ |
| **CONFIG.md** | é…ç½®è¯´æ˜ | â­ å‚è€ƒ |
| **REQUIREMENTS.md** | ä¾èµ–è¯´æ˜ | â­ å‚è€ƒ |
| **æ•°æ®åº“ç»“æ„è¯´æ˜.md** | æ•°æ®åº“ç»“æ„ | â­ å‚è€ƒ |
| **æ–‡ä»¶æ¸…ç†æ–¹æ¡ˆ.md** | æ¸…ç†å»ºè®® | â­ å‚è€ƒ |

---

### âš™ï¸ é…ç½®æ–‡ä»¶ï¼ˆ3ä¸ªï¼‰

| æ–‡ä»¶å | ç”¨é€” | ä¼˜å…ˆçº§ |
|--------|------|--------|
| **config.py** | Flaské…ç½®ï¼ˆç”Ÿäº§/å¼€å‘ï¼‰ | â­â­â­ å¿…éœ€ |
| **gunicorn.conf.py** | Gunicorné…ç½® | â­â­â­ å¿…éœ€ |
| **requirements.txt** | Pythonä¾èµ– | â­â­â­ å¿…éœ€ |

---

### ğŸ Pythonä»£ç 

| ç›®å½•/æ–‡ä»¶ | ç”¨é€” |
|-----------|------|
| **run.py** | åº”ç”¨å…¥å£ |
| **models.py** | æ•°æ®æ¨¡å‹ |
| **routes/** | è·¯ç”±æ¨¡å— |
| **templates/** | HTMLæ¨¡æ¿ |
| **static/** | é™æ€æ–‡ä»¶ |
| **utils/** | å·¥å…·å‡½æ•° |

---

### ğŸ’¾ æ•°æ®ç›®å½•

| ç›®å½• | ç”¨é€” |
|------|------|
| **instance/** | æ•°æ®åº“æ–‡ä»¶ |
| **logs/** | æ—¥å¿—æ–‡ä»¶ |
| **venv/** | Pythonè™šæ‹Ÿç¯å¢ƒ |

---

## ğŸ—‘ï¸ å·²åˆ é™¤çš„æ–‡ä»¶ï¼ˆ28ä¸ªï¼‰

### Shellè„šæœ¬ï¼ˆ8ä¸ªï¼‰
- âŒ setup-nginx.sh
- âŒ fix-nginx-static.sh
- âŒ fix-permissions.sh
- âŒ deploy.sh
- âŒ rollback-server.sh
- âŒ fix-network.sh
- âŒ check-sync.sh
- âŒ sync-all.sh

### æ–‡æ¡£ï¼ˆ9ä¸ªï¼‰
- âŒ æœåŠ¡å™¨æ›´æ–°å®Œæ•´æŒ‡å—.md
- âŒ æœåŠ¡å™¨æ›´æ–°æŒ‡å—.md
- âŒ æœåŠ¡å™¨æ›´æ–°æ­¥éª¤.md
- âŒ äº‘æœåŠ¡å™¨é…ç½®æ£€æŸ¥æŠ¥å‘Š.md
- âŒ ä¿®å¤Nginxé™æ€æ–‡ä»¶é—®é¢˜.md
- âŒ DEPLOY-CLOUD.md
- âŒ CHINA-MIRRORS.md
- âŒ nginxé…ç½®æŒ‡å—.md
- âŒ DOCKER_COMPOSE_éƒ¨ç½²æ–‡ä»¶æ¸…å•.md

### PowerShellè„šæœ¬ï¼ˆ3ä¸ªï¼‰
- âŒ sync-all.ps1
- âŒ check-sync.ps1
- âŒ verify-sync.ps1

### Dockerç›¸å…³ï¼ˆ3ä¸ªï¼‰
- âŒ docker-compose.yml
- âŒ Dockerfile
- âŒ Dockerfile.simple

### å…¶ä»–ï¼ˆ5ä¸ªï¼‰
- âŒ requirements-minimal.txt
- âŒ safe-update.sh
- âŒ safe-update.ps1
- âŒ diagnose-nginx.sh
- âŒ setup-china-mirrors.sh

---

## ğŸ“Š æ¸…ç†æ•ˆæœ

### æ¸…ç†å‰
- æ€»æ–‡ä»¶æ•°: ~50ä¸ª
- Shellè„šæœ¬: 19ä¸ª
- æ–‡æ¡£: 19ä¸ª
- é…ç½®æ–‡ä»¶: 6ä¸ª

### æ¸…ç†å
- æ€»æ–‡ä»¶æ•°: 25ä¸ª
- Shellè„šæœ¬: 9ä¸ªï¼ˆæ ¸å¿ƒï¼‰
- æ–‡æ¡£: 13ä¸ªï¼ˆæ ¸å¿ƒï¼‰
- é…ç½®æ–‡ä»¶: 3ä¸ªï¼ˆæ ¸å¿ƒï¼‰

**å‡å°‘**: 25ä¸ªæ–‡ä»¶ï¼ˆçº¦50%ï¼‰

---

## ğŸ¯ æ ¸å¿ƒæ–‡ä»¶ä½¿ç”¨æŒ‡å—

### é¦–æ¬¡éƒ¨ç½²

```bash
# 1. é…ç½®Git
bash setup-git-config.sh

# 2. æ‰§è¡Œéƒ¨ç½²
sudo bash ubuntu-deploy.sh

# 3. éªŒè¯éƒ¨ç½²
sudo systemctl status crm
curl -I http://localhost/health
```

### æ—¥å¸¸æ›´æ–°

```bash
# å¿«é€Ÿæ›´æ–°ï¼ˆæ¨èï¼‰
bash quick-update.sh

# æˆ–æ‰‹åŠ¨æ›´æ–°
git pull origin master
sudo systemctl restart crm
```

### å®Œæ•´å¤‡ä»½

```bash
# å¤‡ä»½åˆ°Gitee bakåˆ†æ”¯
bash backup-to-gitee.sh

# ä»bakåˆ†æ”¯æ¢å¤
bash restore-from-bak.sh
```

### å¥åº·æ£€æŸ¥

```bash
# æ‰‹åŠ¨å¥åº·æ£€æŸ¥
bash health-check.sh

# æˆ–è®¾ç½®å®šæ—¶ä»»åŠ¡
*/5 * * * * /root/crm/health-check.sh
```

---

## ğŸ“ æ¨èçš„ç›®å½•ç»“æ„

```
crm/
â”œâ”€â”€ ğŸ“œ éƒ¨ç½²è„šæœ¬ï¼ˆ9ä¸ªï¼‰
â”‚   â”œâ”€â”€ ubuntu-deploy.sh          â­â­â­ ä¸€é”®éƒ¨ç½²
â”‚   â”œâ”€â”€ quick-update.sh           â­â­â­ å¿«é€Ÿæ›´æ–°
â”‚   â”œâ”€â”€ health-check.sh           â­â­ å¥åº·æ£€æŸ¥
â”‚   â”œâ”€â”€ backup-to-gitee.sh        â­â­ å®Œæ•´å¤‡ä»½
â”‚   â”œâ”€â”€ restore-from-bak.sh       â­â­ æ¢å¤å¤‡ä»½
â”‚   â”œâ”€â”€ setup-git-config.sh       â­ Gité…ç½®
â”‚   â”œâ”€â”€ fix-git-conflict.sh       â­ å†²çªä¿®å¤
â”‚   â”œâ”€â”€ verify-update.sh          â­ éªŒè¯æ›´æ–°
â”‚   â””â”€â”€ cleanup-files.sh          â­ æ¸…ç†æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“š æ–‡æ¡£ï¼ˆ13ä¸ªï¼‰
â”‚   â”œâ”€â”€ README.md                 â­â­â­ é¡¹ç›®è¯´æ˜
â”‚   â”œâ”€â”€ Ubuntuç›´æ¥éƒ¨ç½²æŒ‡å—.md     â­â­â­ éƒ¨ç½²æŒ‡å—
â”‚   â”œâ”€â”€ Ubuntuéƒ¨ç½²æ–¹æ¡ˆæ€»ç»“.md     â­â­â­ æ–¹æ¡ˆæ€»ç»“
â”‚   â”œâ”€â”€ Ubuntuéƒ¨ç½²é—®é¢˜ä¿®å¤.md     â­â­ é—®é¢˜ä¿®å¤
â”‚   â”œâ”€â”€ Ubuntuéƒ¨ç½²æœ€ç»ˆæ£€æŸ¥æ¸…å•.md â­â­ æ£€æŸ¥æ¸…å•
â”‚   â”œâ”€â”€ éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”ä¸å»ºè®®.md     â­â­ æ–¹æ¡ˆå¯¹æ¯”
â”‚   â”œâ”€â”€ å¤‡ä»½æ¢å¤æŒ‡å—.md           â­â­ å¤‡ä»½æ¢å¤
â”‚   â”œâ”€â”€ æ•°æ®åº“ç®¡ç†è¯´æ˜.md         â­â­ æ•°æ®åº“ç®¡ç†
â”‚   â”œâ”€â”€ å®‰å…¨æ›´æ–°ä½¿ç”¨æŒ‡å—.md       â­ æ›´æ–°æŒ‡å—
â”‚   â”œâ”€â”€ CONFIG.md                 â­ é…ç½®è¯´æ˜
â”‚   â”œâ”€â”€ REQUIREMENTS.md           â­ ä¾èµ–è¯´æ˜
â”‚   â”œâ”€â”€ æ•°æ®åº“ç»“æ„è¯´æ˜.md         â­ æ•°æ®åº“ç»“æ„
â”‚   â””â”€â”€ æ–‡ä»¶æ¸…ç†æ–¹æ¡ˆ.md           â­ æ¸…ç†æ–¹æ¡ˆ
â”‚
â”œâ”€â”€ âš™ï¸ é…ç½®æ–‡ä»¶ï¼ˆ3ä¸ªï¼‰
â”‚   â”œâ”€â”€ config.py                 â­â­â­ Flaské…ç½®
â”‚   â”œâ”€â”€ gunicorn.conf.py          â­â­â­ Gunicorné…ç½®
â”‚   â””â”€â”€ requirements.txt          â­â­â­ Pythonä¾èµ–
â”‚
â”œâ”€â”€ ğŸ Pythonä»£ç 
â”‚   â”œâ”€â”€ run.py                    åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ models.py                 æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ routes/                   è·¯ç”±æ¨¡å—
â”‚   â”œâ”€â”€ templates/                HTMLæ¨¡æ¿
â”‚   â”œâ”€â”€ static/                   é™æ€æ–‡ä»¶
â”‚   â””â”€â”€ utils/                    å·¥å…·å‡½æ•°
â”‚
â””â”€â”€ ğŸ’¾ æ•°æ®ç›®å½•
    â”œâ”€â”€ instance/                 æ•°æ®åº“æ–‡ä»¶
    â”œâ”€â”€ logs/                     æ—¥å¿—æ–‡ä»¶
    â””â”€â”€ venv/                     è™šæ‹Ÿç¯å¢ƒ
```

---

## ğŸ’¡ æ–‡ä»¶ä¼˜å…ˆçº§è¯´æ˜

### â­â­â­ å¿…éœ€æ–‡ä»¶
- éƒ¨ç½²å’Œè¿è¡Œå¿…é¡»çš„æ–‡ä»¶
- åˆ é™¤ä¼šå¯¼è‡´ç³»ç»Ÿæ— æ³•è¿è¡Œ

### â­â­ æ¨èæ–‡ä»¶
- å¼ºçƒˆæ¨èä¿ç•™çš„æ–‡ä»¶
- æä¾›é‡è¦åŠŸèƒ½å’Œæ–‡æ¡£

### â­ å¯é€‰æ–‡ä»¶
- è¾…åŠ©å·¥å…·å’Œå‚è€ƒæ–‡æ¡£
- å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©æ€§ä½¿ç”¨

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–°æœåŠ¡å™¨éƒ¨ç½²

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://gitee.com/blebleman/crm.git ~/crm
cd ~/crm

# 2. é…ç½®Git
bash setup-git-config.sh

# 3. éƒ¨ç½²
sudo bash ubuntu-deploy.sh

# 4. éªŒè¯
sudo systemctl status crm
curl http://localhost/health
```

### ä»£ç æ›´æ–°

```bash
cd ~/crm
bash quick-update.sh
```

### å®Œæ•´å¤‡ä»½

```bash
cd ~/crm
bash backup-to-gitee.sh
```

---

## ğŸ“ æ–‡æ¡£ç´¢å¼•

### éƒ¨ç½²ç›¸å…³
- **Ubuntuç›´æ¥éƒ¨ç½²æŒ‡å—.md** - è¯¦ç»†éƒ¨ç½²æ­¥éª¤
- **Ubuntuéƒ¨ç½²æ–¹æ¡ˆæ€»ç»“.md** - æ–¹æ¡ˆå®Œæ•´æ€»ç»“
- **Ubuntuéƒ¨ç½²é—®é¢˜ä¿®å¤.md** - é—®é¢˜æ’æŸ¥å’Œä¿®å¤

### æ›´æ–°ç›¸å…³
- **å®‰å…¨æ›´æ–°ä½¿ç”¨æŒ‡å—.md** - æ›´æ–°æµç¨‹è¯´æ˜
- **quick-update.sh** - å¿«é€Ÿæ›´æ–°è„šæœ¬

### å¤‡ä»½ç›¸å…³
- **å¤‡ä»½æ¢å¤æŒ‡å—.md** - å¤‡ä»½æ¢å¤è¯¦ç»†è¯´æ˜
- **backup-to-gitee.sh** - å¤‡ä»½è„šæœ¬
- **restore-from-bak.sh** - æ¢å¤è„šæœ¬

### é…ç½®ç›¸å…³
- **CONFIG.md** - é…ç½®è¯´æ˜
- **REQUIREMENTS.md** - ä¾èµ–è¯´æ˜
- **æ•°æ®åº“ç®¡ç†è¯´æ˜.md** - æ•°æ®åº“ç®¡ç†

---

**æ¸…ç†å®Œæˆæ—¶é—´**: 2025-01-02  
**å½“å‰ç‰ˆæœ¬**: 2.0  
**çŠ¶æ€**: âœ… å·²ä¼˜åŒ–ï¼Œç”Ÿäº§å°±ç»ª

